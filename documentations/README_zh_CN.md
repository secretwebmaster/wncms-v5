# Wncms 项目介绍
演示: [demo.wncms.cc](https://demo.wncms.cc)

## 更新日志

### v4.5.0 (开发中)

### v4.4.0 2024-09-18
- 添加了后台更新通知功能。
- 更新了模型创建函数，以确保与自定义模型和控制器的兼容性。
- 修复了模型分页，准确显示最后一页的项目数量。
- 在设置中添加了禁用核心更新的选项。
- 在 `README.md` 中包含了演示 URL。
- 更新了错误页面。
- 添加了翻译。
- 引入了更新设置的命令。
- 添加了主题控制器。

### v4.3.0 2024-09-14
- 测试新的安装过程
- 停止追踪 vendor 目录
- 更新后台页脚年份为动态更新
- 在安装前将预设快取驱动程式更新为 null
- 更新 README.md
- 改进预设模板
- 更新安装程式图示。安装时自动添加强制 HTTPS 设定
- 向安装程式添加错误讯息
- 在安装过程中添加选择 Redis、Memcache、文件作为快取驱动程式的选项
- 将预设 DB_CONNECTION 设为内存中的假 SQLite。将预设 SESSION 驱动程式设为文件
- 禁用安装过程中的 trait 文件生成
- 在系统设定中添加强制 HTTPS 选项
- 添加预设 env 文件
- 更新 .gitignore
- 更新 composer 依赖
- 更新主题选项面板
- 改进首次网站创建流程
- 移除调试讯息
- 修正后台样式
- 重命名 Traits。修正安装错误。添加强制 HTTPS 相容性
- 在要求之前检查自定义语言文件是否存在

### v4.2.0 2024-09-13
- 移除 WnTagTraits.php
- 在生成示例文章内容时添加翻译
- 改进预设首页模板。添加文章存档 URL
- 添加更多翻译
- 修正添加第二个网站时的错误

### v4.1.0 2024-09-07
- 添加强制 HTTPS 选项
- 小幅修正
- 更新预设 env 文件以隐藏调试讯息
- 安装和网站创建后清除快取
- 添加 PHP 函数需求检查
- 将 database.sqlite 添加到 .gitignore
- 修正创建主题命令。根据 Laravel 11 结构更新 lang 目录
- 修正广告过期日期不能为空的错误
- 移除无用的 UpdateLog 模型
- 更新预设模型设定
- 更新安装程式
- 添加禁用用户注册功能
- 在网站编辑页面上将主题设置为 null 而非预设

### v4.0.0 2024-08-03
#### 新增
- PHP 需求从 7.2+ 升级至 8.2+
- Laravel 10 -> 11
- jQuery 3.2.1 -> 3.7.1
- 更新所有 composer 依赖
- 添加数据库前缀以避免与 MySQL 保留关键字的表名衝突
#### 修复
- 修正当 CMS 未安装时导航 panel/xxxx 页面的错误
- 修正 php artisan migrate:fresh 不工作
- 修正当 $request-input 为 null 时页面控制器错误
#### 优化
- 合併旧迁移并重命名迁移文件
- 重命名资料库列 external_image -> external_thumbnail
- 更新预设 env 文件生成器
- wncms_get_unique_slug() 将预设长度设为 8
- 所有 // 注释后应留有空格。例如 // Good 和 //Bad
- 重写 wncms.js 和 AuthenticatedSessionController 中的登入逻辑
#### 移除
- 移除 vendor 目录以缩小包大小。安装过程中将下载包
- 移除全域函数 wn()，全部替换为 wncms()
- 移除全域变数 $wn，全部替换为 $wncms
- 移除分析帮助程式以避免性能问题。用第三方分析工具替代
- 移除 wncms_get_theme_options() 帮助函数。在模型中使用 $website->get_options()

### v3.2.1 2024-05-19
#### 新增
- 新增数个旗次SVG
- 增加更多翻译字段
- 后台各模组数据列表加入权限判断
- 后台新增菜单判断非管理员权限
- 预留1个代理Dashboard，供日后开发使用
#### 修复
- 修复部分大小写错误
#### 优化
- common.table_status.blade.php 可以判断更多状态，新增自定功能

### v3.2.0 2024-03-14
#### 修复
- 修复新版本安装时site_name为null报错
#### 优化
- 更新安装程序
- 使用api_token请求时，视爲登入

### v3.1.15 2024-03-12
#### 新增
- 新增Page模组的API
- 新增菜单模组API
- PostHelper getList() 支持 $isRandom 参数，可以获取随机文章
- Post模组新增 getTags ，获取Tag列表，可传入 $type参数
- WebsiteHelpr 新增排序功能
- 优化主题设定判断可以分辨 0 和 未设定
- 新增一键複杂菜单功能
#### 修复
- 修复联络表单中current_url项被缓存问题
- 修复表单提交失败时按钮文字不显示
#### 优化
- 计划移除Post模组 getFirstCategory()，一律改为使用 getFirstTag('post_category')
- 优化手机版后台UI
- 生成主题档案时，会自动替换starter字串为主题名称，无需再手动修改
- 主题名称按英文字母顺序排列
- 文章搜索前，先判断是否包括keyword
- 优化主题设定判断，可以分辨 0 和 未设定
- 后台Tag显示相关模组数量
- 所有Helper预设改为不使用分页 $pageSize = 0

___
### v3.1.14 2023-12-17
#### 新增
- 批量複製文章功能

___
### v3.1.13 2023-12-12
#### 新增
- 模组列表的工具列，可以设定隐藏部分预设按钮，例如 'hideToolbarStatusFiller' => true 可以隐藏状态筛选下拉清单
- 联络表单增加提交后的js事件，可以针对成功及失败分别设定
- 后台联络表单增加筛选功能
- 后台联络表单增加汇出 XLXS/CSV 功能
- 增加翻译字段
#### 修复
- 修复假浏览量小数问题
#### 优化
- 调整部分后台UI

___
### v3.1.12 2023-12-11
#### 新增
- 系统设定中，加入上传封面图片时，自动转换为webp
- 模组加入额外参数功能 ExtraAttribute，使用 getExtraAttribute() 和 saveExtraAttribute()
#### 修复
- 修复主题设定中，开关的说明有时候会重覆显示

___
### v3.1.11 2023-12-08
#### 新增
- 更多翻译字段
#### 修复
- 修复主题设定图片若带括号()未能显示
#### 优化
- utm参数支持带到著陆以外的其他页面

___
### v3.1.10 2023-12-08
#### 新增
- 联络表单支持调整栏位顺序
- 新增数项系统设定，设定超级管理员收件帐号
- 新增SMTP测试电邮功能
- 更新部分翻译字段
- 联络表单现支持单选及多选
- 联络表单现支持检查是否所有必须填写项目都已填写
#### 修复
- 修复手机版主题设定因网站名称过长而跑版
- 修复部分模组未能批量删除
- 修复文章回收时，未有更新状态
#### 优化
- 更新预设Email模版，支持html

___
### v3.1.9 2023-12-06
#### 新增
- 新增Starter主题的 style.css 和 main.js
#### 修复
- 修复部分主题页面的部件未能读取
#### 优化
- 获取文章时，如果指定了排除的分类ID，也会包括没有分类的文章
- 更新表单系统，使用新的模版调用方法 $wncms->contact_form()->render()，直接生成表单结构
- 更新常见问题模组，增加更多栏位，可设定排序

___
### v3.1.8 2023-11-29
#### 新增
- 新增json-id结构

___
### v3.1.7 2023-11-21
#### 新增
- 优化后台手机版UI
- 所有上传图片模组，支缓更多图片类型
- 新增一键汇入预设主题设定功能
#### 修复
- 修复文章上限少于分页数量时，可能不显示的问题
#### 优化
- 升级主题设定中的文本编辑器
- 更新翻译字段

___
### v3.1.6 2023-11-17
#### 新增
- 文章批量指派到网站功能
- 新增点击事件纪录，属性为[wncms-click]
- 新增显示网站浏览量 (有别于文章浏览量，网站浏览量为全局，查看多少文章都只计算1次)
- 更多翻译字段
- 系统设定新增浏览量，访问量冷却间隔，可以设定60分钟算一次，或1440分钟计算一次，自行输入分钟
- 广告位加入多筛选条件

___
### v3.1.5 2023-11-16
#### 新增
- 菜单项目可以新增描述
- [开发者] 新增Wiget系统，用于建立Page template，增加可重用性
- [开发者] 初引入Sortable JS插件
- [开发者] 后台backend.blade.php加入可堆叠css位置，使用@push('foot_css')
- 更多翻译字段
- 新增一键生成演示文章功能，方便开发
- [开发者] 新增第4个常用简称涵数gpto (getPageTemplateOption)，用于在page页面中，获取个别页面参数
#### 修
- 修复Ajax联络表单返回讯息， 成功建立 改为 成功提交

#### 优化
- 页面樊组option栏位由json类型改为text类型，防止自动排序
- 修改单页加载顺序， template > plain > static ，都没有就跳转主页
- 修正以\#开头的菜单连结未能正常跳转锚点
- 修化手机版后台主题设定样式
- [开发者] 大幅修改后台input.blade.php的判断条件，为可视化编辑器作准备

___
### v3.1.4 2023-11-04
#### 新增
- [开发者] 模版中新增 $wncms 参数，等同于 $wn
- [开发者] 新增wncms()->paginateWithLimit() 方法，解决 paginate 不能与 limit同时使用的问题
- 更多翻译字
- 缓存讚好数，每日使用排程任务更新到模组 like 栏位，可加速不需要实时讚好数的模组
- 更新 RecordViews 排程任务，可以纪录任何 collection，例如visit, like, dislike
- [开发者] 新增 $wn->addVersion()，不需要再于模版中加上 '?v=' . $wn->getVersion()，新功能输出时已包括 ?v=
- 引入 applicaion/ld+json 选项，可以Push到 `<head>` 中
#### 修复
- 修复3.1.3更新后，部分页面未能读取内容

#### 优化
- 预设主题 `<title>` 从「首页」改为网站名称
- 优化新增同名权限时的提示，不再是报错，而是提示已有重覆项目
- [开发者] 重新命名前端视图中的统计部分 get_view -> get, record_like -> like, record_view -> record

___
### v3.1.3 2023-10-31
#### 新增
- 更新后台菜单模组图标
- 新增从文字中提取域名
- 广告更换为可以设定永久广告
- [开发者] 新增页面模版功能，开发者可建立Blade档案，用于页面管理中，一键生成页面
- 修复颜色表选项不显示当前值
- 新增菜单Tag项目可以一键获取多国语言功能，获取后仍然可以自订各语言显示文字
- 新增更多预设广告位置
- [开发者] 新增日期标示模块 resources/views/common/table_date.blade.php ，根据日期与当前时间的距离，以不同颜色标示
- [开发者] 新判断某连结是否与当前页面连结相同，wncms()->isActiveUrl()
- 新增更多翻字段
- 新增文章排行榜功能 /psots/rank, /post/rank/{$period} ，可以按日週月年总排列
- [开发者] 新增WnMediaTraits，暂时只有1个功能，$this->addThumbnailFromRequest()，可以直接从request中上传图片
- [开发者] WnTgTraits 新增 getFirstTag() 功能，以获取任何Model的第一个Tag
- [开发者] CacheHelper 新 get() 和 put() 功能
- [开发者] MenuHelper新增以输出theme_page连结，与 external_link 差不多
- 新增一键複製广告功
#### 修复
- [开发者] 修复更新Laravel版本后，Stub文件被覆盖，导致模组生成器模版还原为设设
- 修复会员后面版错误
- 修复开启缓存时，Tag分页只显示第1页缓存问题
- 修复部分模组，管理员没有初始权限问题
- 修复菜单项目更新后，排序可能会乱掉问题
#### 优化
- [开发者] 优代从字段中获取连结功能，可选择保留www， wncms()->getDomainFromString($string, $includePort = true, $preserveWWW = false)

___
### v3.1.2 2023-10-28
#### 新增
- 使用新的Redis缓存库，可以清理个别标籤
- 新增后台一键清理缓存功能
- [开发者] 新增从String获取域名+端口的方法，wncms()->getDomainFromString()
#### 优化
- [开发者] 整理代码
- [开发者] Theme helper修改为不受缓存设定影响，即使关闭缓存，仍然会套用数据缓存的时间，预设为3600秒，以防闭闭缓存后，一个页面请求几十次数据库只为了读取主题设定
- [开发者] 更新CSRF路径
- 修复主题设定中，Tinymce编辑器无效
- [开发者] TagHelper中，getList() 新增可以只获取父级分Tag
- 更新文章AP
- 更新WNCMS安装程序，简化流程

___
### v3.1.1 2023-10-20
#### 新增
- 重製安装流程，更简单快速
- [开发者] Starter中的tagify栏位，改为可以输入开关字搜索
- [开发者] 开发者可以自订管理员控制台项目
- [开发者] 开发者可以自订会员主页项目
- 添加更多翻译字段
#### 修复
- 修复部分模组未能清除标籤
#### 优化
- [开发者] 后台Sidebar Model部分重构，开发者可以自订后台Model菜单顺序，修改Model中的$menuPriority property
- [开发者] 更新 controller.model.stub
- 重写注册会员逻辑

___
### v3.0.8 2023-10-18
#### 新增
- [开发者] 更新Wncms core class，可以任意配额参数 $wn->anything = 'something';
- [开发者] 更新Wncms core class，更有效重用Helper Classes

___
### v3.0.7 2023-10-17
#### 新增
- 联络表单新增批量处理功能，可以批量设为已读，批量设为未读，批量设为已回覆
- 新增网站级的缓存
- 新增备用域名系统
- 部分后台页面开始增加数据数量资讯，例如总数，及当前正在显示第几条数据
- 新增广告模组
#### 优化
- 更新Ajax按钮发送数据模式
- 优化系统设定缓存
- 升级tinymce编辑器，使用cloudflare CDN

___
### v3.0.6 2023-10-09
#### 新增
- 新增更多翻译字段
- [开发者] 新增table_url Blade视图
- [开发者] webphp 路游新增演示模组
- [开发者] starter/index.bade.php 视图新增再製按钮
- [开发者] Tag模组新增 WnTagTraits 特徵，增 getAvailableTypes()，可以获取分类法列表 ['post_tag', 'video_category', etc]

___
### v3.0.5 2023-10-07
#### 新增
- 检查自定模组是否存在 (Custom{Model}Traits.php)

___
### v3.0.4 2023-10-07
#### 修复
- 修复部分模组小问题
#### 优化
- 优化后台UI

___
### v3.0.3 2023-10-06
#### 优化
- 更新文章模组，修复会员权限问题
- 移动Trait目录到Ap目录下

___
### v3.0.2 2023-09-30
#### 新增
- 新增Page类型 (纯文字类型，由编辑器製作的模版，由主题提供的模版)

___
### 2.0.0 2021-07-28
- 全新版本发行! (相关更新纪录已隐藏)

___
### 1.0.0 2019-03-01
- 首版本发行 (相关更新纪录已隐藏)
